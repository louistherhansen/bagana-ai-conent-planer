# BAGANA AI — CrewAI task definitions (MVP: 3 core tasks)
# Source: PRD §3, SAD §2; adapter: .cursor/rules/adapter-crewai.mdc
# Context bindings resolved at runtime in crew/run.py.
# MVP Flow per SAD §2: content_planner → (sentiment_analyst, trend_researcher) with shared plan context
# Sequential execution for deterministic builds per adapter rules.

tasks:
  create_content_plan:
    name: create_content_plan
    agent: content_planner
    description: |
      Create a structured multi-talent content plan from user input. Include calendars, briefs, messaging, talent assignments.
      User input: {user_input}
      Do: extract brand/campaign/talent; design strategy and objectives; assign talents to themes/formats; content calendar and distribution; messaging pillars; content formats (short/long video, live, carousel, educational); creative brief summaries.
      Output in {output_language} only. Plain Markdown, NO code fences. Required headings: Strategic Overview, Objectives, Talent Assignments, Content Themes, Content Calendar and Timeline, Key Messaging, Content Formats, Distribution Strategy, Audit. If any missing, write Diagnostic and halt.
    expected_output: |
      Artifact project-context/2.build/artifacts/content_strategy.md. Headings: Strategic Overview, Objectives, Talent Assignments, Content Themes, Content Calendar and Timeline, Key Messaging, Content Formats, Distribution Strategy, Audit. Language: {output_language}. Plain Markdown only, no code fences.
    output_file: project-context/2.build/artifacts/content_strategy.md
    create_directory: true
    context: []  # First task; receives brand input via inputs

  analyze_sentiment:
    name: analyze_sentiment
    agent: sentiment_analyst
    description: |
      Analyze content plan (context) for sentiment and risks. First line MUST be: "Sentiment Composition (Pie Chart): Positive X%, Neutral Y%, Negative Z%" (X+Y+Z=100).
      Then: # Sentiment and Risk Analysis Report for [Brand]; sentiment score + drivers/triggers; audience sensitivity; platform risks (YouTube, Instagram, TikTok, X, LinkedIn); controversy/misinformation/legal flags; Risk Severity; mitigation; Go/Caution/No-Go for Influencer Endorsement.
      Output in {output_language} only. Plain Markdown, NO code fences. Include all expected_output headings or write Diagnostic and halt.
    expected_output: |
      Artifact project-context/2.build/artifacts/sentiment.md. First line: Sentiment Composition (Pie Chart): Positive X%, Neutral Y%, Negative Z%. Headings: # Sentiment and Risk Analysis Report; ## Sentiment Summary (Overall Score, Key Positive/Negative Drivers); ## Identified Risks (Audience Sensitivity, Platform-Specific Risk Matrix, Controversy Scenarios, Misinformation & Claim Risk, Cultural/Legal/Ethical Flags); ## Risk Mitigation (Severity, Mitigation Actions); ## Opportunities; ## Recommendations (Go/Caution/No-Go). Language: {output_language}. No code fences.
    output_file: project-context/2.build/artifacts/sentiment.md
    create_directory: true
    context_from: [create_content_plan]  # Resolved to Task refs in code

  research_trends:
    name: research_trends
    agent: trend_researcher
    description: |
      Use content plan (context). Summarize market/trend insights; creator economy focus.
      Include # Summary Bar Chart Data after Key Market Trends: format "Trend Name | Value" (Value 0-100, one line per trend). Include Trend Line Chart Data: "Trend Name | Period1:Val1, Period2:Val2, ..." (values 0-100). Cover: key trends, audience/platform patterns, timing, competitors, content format trends, recommendations.
      Output in {output_language} only. Plain Markdown, NO code fences. All expected_output headings or write Diagnostic and halt.
    expected_output: |
      Artifact project-context/2.build/artifacts/trends.md. Headings: # Key Market Trends; # Summary Bar Chart Data (Trend Name | Value, 0-100); # Creator Economy Insights; # Competitive Landscape; # Content Format Trends; # Timing and Seasonality; # Implications for Strategy; # Recommendations; # Sources; # Audit. Trend Line Chart Data format: Trend Name | Period:Value,.... Language: {output_language}. No code fences.
    output_file: project-context/2.build/artifacts/trends.md
    create_directory: true
    context_from: [create_content_plan]  # Resolved to Task refs in code
